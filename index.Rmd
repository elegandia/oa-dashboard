---
title: "Open Access Dashboard "
output: 
  flexdashboard::flex_dashboard:
    orientation: rows
    vertical_layout: scroll
    source_code: embed
    
# author: Jan Taubitz
# email: jan.taubitz@charite.de
---

```{r setup, include=FALSE}
library(flexdashboard)

source("data_1.R", encoding = 'UTF-8')
source("rcrossref.R", encoding = 'UTF-8')
```

<style>
body {
  max-width: 1200px; 
  margin: 0 auto 0 auto;
}
</style>

Row 
-----------------------------------------------------------------------

```{r}
########################### Analysis ###########################

# Percent of article that were oa
# Percent of article with Corresponding author
# Percent of articles that were published in a doaj-journal

load("data/data_unpaywall.Rda")

is_oa <- data %>%
  group_by(jahr, is_oa) %>%
  summarise(value = n()) %>%
  mutate(perc = round(value / sum(value) * 100, 1))

is_doaj <- sort(table(data_unpaywall$journal_is_in_doaj), decreasing = TRUE)
is_doaj <- round(4152/sum(is_doaj)*100, 1)

is_corresponding <- sort(table(data$corresponding_author_cha), decreasing = TRUE)
is_corresponding <- round(6292/sum(is_corresponding)*100, 1)
```


### Open Access-Artikel 2018

```{r}
rate <- is_oa %>% filter(jahr == 2018 & is_oa == TRUE) %>% pull(perc)


gauge(rate, min = 0, max = 100, symbol = ' %', label= "Daten von Medbib", gaugeSectors(
  success = c(50, 100), warning = c(30, 49), danger = c(0, 29)
))
```

### Open Access-Artikel 2019

```{r}
rate <- is_oa %>% filter(jahr == 2019 & is_oa == TRUE) %>% pull(perc)

gauge(rate, min = 0, max = 100, symbol = ' %', label= "Daten von Medbib", gaugeSectors(
  success = c(50, 100), warning = c(30, 49), danger = c(0, 29)
))
```

### Open Access-Artikel 2020

```{r}
rate <- is_oa %>% filter(jahr == 2020 & is_oa == TRUE) %>% pull(perc)

gauge(rate, min = 0, max = 100, symbol = ' %', label= "Daten von Medbib", gaugeSectors(
  success = c(50, 100), warning = c(30, 49), danger = c(0, 29)
))
```


Row 
-----------------------------------------------------------------------

### Autor ist Corresponding 2018-2020

```{r}
rate <- is_corresponding
gauge(rate, min = 0, max = 100, symbol = ' %', label= "Daten von Medbib", gaugeSectors(
  success = c(40, 100), warning = c(30, 39), danger = c(0, 29)
))
```

### Journal ist DOAJ 2018-2020

```{r}
rate <- is_doaj
gauge(rate, min = 0, max = 100, symbol = ' %', label= "Daten von Unpaywall", gaugeSectors(
  success = c(50, 100), warning = c(20, 49), danger = c(0, 19)
))
```

Row {data-height=120}
-----------------------------------------------------------------------

### Analyse 1

<font size="6"> Open Access-Status von Artikeln mit Charité-Beteiligung insgesamt und von Artikeln mit Charité-Corresponding Author 2018-2020</font>


Row {data-height=500}
-----------------------------------------------------------------------


### Artikel mit Charité-Beteiligung

```{r}
status_percent
```

### Artikel mit Charité-Corresponding Author

```{r}
status_corresponding_percent
```


Row {data-height=120}
-----------------------------------------------------------------------

### Analyse 2

<font size="6"> Open Access-Status von Artikeln mit Charité-Beteiligung auf Verlags- und Journal-Ebene im Jahr 2020 </font>


Row {data-height=500}
-----------------------------------------------------------------------

### Publisher in absolute numbers

```{r}
publisher_absolute
```

### Journals in absolute numbers

```{r}
journal_absolute
```


Row {data-height=120}
-----------------------------------------------------------------------

### Analyse 3

<font size="6"> Median und Mittelwert der Zitierungen von den 2018 publizierten Artikeln mit Charité-Beteiligung (Daten von Crossref)</font>

Row 
-----------------------------------------------------------------------

###

```{r}
median_citation
```

###

```{r}
mean_citation
```


Row {data-height=120}
-----------------------------------------------------------------------

### Analyse 4

<font size="6"> Lizenzen der mit Charité-Beteiligung publizierten Artikel</font>

Row 
-----------------------------------------------------------------------

###

```{r}
load("charts/chart_lizenzen.Rda")
chart_lizenzen
```

###

```{r}
load("charts/chart_lizenzen_oa.Rda")
chart_lizenzen_oa
```


Row {data-height=100}
-----------------------------------------------------------------------

### Analyse 5

<font size="4"> Ein <b>Itemchart</b> zeigt jeden Artikel als einzelnen Punkt. Durch den Itemchart kann in einem Jahresvergleich gut die absolute Anzahl der Artikel repräsentiert als auch das prozentuale Verhältnis des OA-Status angezeigt werden.</font>


Row {data-height=150}
-----------------------------------------------------------------------

### 2018 - Open Access-Status von Artikeln mit Charité-Corresponding Author

```{r}
item_2018
```

Row {data-height=150}
-----------------------------------------------------------------------
### 2019 - Open Access-Status von Artikeln mit Charité-Corresponding Author

```{r}
item_2019
```
Row {data-height=200}
-----------------------------------------------------------------------
### 2020 - Open Access-Status von Artikeln mit Charité-Corresponding Author

```{r}
item_2020
```
